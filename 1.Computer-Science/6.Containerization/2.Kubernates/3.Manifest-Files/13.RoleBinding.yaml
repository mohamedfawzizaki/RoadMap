# ================================================================================
# ğŸ“˜ Definition: RoleBinding
# --------------------------------------------------------------------------------
# RoleBinding grants the permissions defined in a Role (namespaced) to a subject
# (User, Group, or ServiceAccount) **within the same namespace**.
#
# RoleBindings can only reference:
#   âœ”ï¸ Role (in the same namespace)
#   âœ”ï¸ ClusterRole (applies limited to this namespace)
#
# ğŸ” Use case: Grant a CI/CD ServiceAccount access to deploy/manage workloads
# in a specific namespace using the permissions defined in a Role.
# ================================================================================

# --------------------------------------------------------------------------------
# ğŸ”— RoleBinding: Binds CI ServiceAccount to the ci-role Role in ci-namespace
# --------------------------------------------------------------------------------
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: ci-rolebinding                         # ğŸ†” Name of the binding
  namespace: ci-namespace                      # ğŸ—‚ï¸ Must match Role's and SA's namespace
subjects:
  - kind: ServiceAccount                       # ğŸ‘¤ Type of subject (User, Group, or ServiceAccount)
    name: ci-serviceaccount                    # ğŸ”‘ Name of the ServiceAccount being granted access
    namespace: ci-namespace                    # ğŸŒ Namespace where the SA resides
  # - kind: User                               # ğŸ‘¤ Subject type: individual user
  #   name: alice@example.com                  # ğŸ” Must match external identity (from OIDC, LDAP, etc.)
  #   apiGroup: rbac.authorization.k8s.io
  # - kind: Group                              # ğŸ‘¥ Subject type: user group
  #   name: devops-team                        # ğŸ·ï¸ Group name from your identity provider
  #   apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role                                   # ğŸ“ Binding to a namespaced Role (not ClusterRole)
  name: ci-role                                # ğŸ›¡ï¸ Name of the Role this binding refers to
  apiGroup: rbac.authorization.k8s.io          # ğŸ”§ Always rbac.authorization.k8s.io



