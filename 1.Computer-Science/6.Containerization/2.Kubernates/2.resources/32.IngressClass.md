___________________________________________________________________________________________________________________________

---

# What is an IngressClass?

An **IngressClass** is a Kubernetes resource that defines a class of Ingressâ€”essentially specifying which **Ingress controller** should implement a given Ingress resource.

* It decouples the Ingress resource from the Ingress controller implementation.
* Allows running multiple Ingress controllers in a cluster, each handling different Ingresses based on class.
* Introduced to replace the earlier approach where the Ingress controller watched all Ingresses.

---

# Why use IngressClass?

* When multiple Ingress controllers coexist, each can specify an **IngressClass** to pick which Ingresses to serve.
* Provides a clean way to configure and distinguish between different controllers.
* Avoids conflicts between different ingress controllers.

---

# How does it work?

* Each Ingress resource references an IngressClass via the `ingressClassName` field.
* The IngressClass resource defines the controller that should serve Ingresses of that class.
* Controllers watch for Ingress resources that reference their class and only process those.

---

# IngressClass YAML Example

```yaml
apiVersion: networking.k8s.io/v1
kind: IngressClass
metadata:
  name: nginx
spec:
  controller: k8s.io/ingress-nginx
```

* **`metadata.name`** is the name used in Ingress resource's `ingressClassName`.
* **`spec.controller`** is a domain-like string identifying the controller implementation.

---

# Example Ingress Resource Using IngressClass

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: example-ingress
spec:
  ingressClassName: nginx
  rules:
  - host: example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: example-service
            port:
              number: 80
```

Here, only the Ingress controller with `controller: k8s.io/ingress-nginx` (named `nginx`) will handle this Ingress.

---

# Key Fields of IngressClass

| Field             | Description                                                                   |
| ----------------- | ----------------------------------------------------------------------------- |
| `metadata.name`   | The name of the IngressClass (used by Ingress resources)                      |
| `spec.controller` | Identifier of the controller that implements this class                       |
| `spec.parameters` | (Optional) Reference to a config resource with controller-specific parameters |

---

# Spec.parameters (Optional)

* Some Ingress controllers support a **parameters** field for extra config.
* It references a Kubernetes resource (ConfigMap, CustomResource) with specific settings for that controller.
* Example:

```yaml
spec:
  controller: k8s.io/ingress-nginx
  parameters:
    apiGroup: k8s.nginx.org
    kind: NginxIngressControllerConfig
    name: nginx-config
```

---

# Notes

* Before Kubernetes v1.18, the `kubernetes.io/ingress.class` annotation was used; now `ingressClassName` is preferred.
* If `ingressClassName` is omitted, some controllers may default to a configured class or serve all Ingresses.
* It's recommended to always specify `ingressClassName` to avoid ambiguity in multi-controller clusters.

---

# Summary

| Concept          | Description                                                  |
| ---------------- | ------------------------------------------------------------ |
| IngressClass     | Defines which controller serves a class of Ingress resources |
| ingressClassName | Field in Ingress resources that references IngressClass      |
| controller       | Identifier string for controller implementation              |
| parameters       | Optional reference to additional controller config           |

---
