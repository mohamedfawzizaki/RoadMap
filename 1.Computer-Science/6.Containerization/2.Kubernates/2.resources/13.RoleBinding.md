___________________________________________________________________________________________________________________________

---

## üîê What is a RoleBinding?

A **`RoleBinding`** is a Kubernetes RBAC (Role-Based Access Control) object that **grants permissions** defined in a `Role` or `ClusterRole` to one or more **subjects** (users, groups, or service accounts) **within a specific namespace**.

> It‚Äôs the bridge that says: ‚ÄúApply this set of permissions to this identity inside this namespace.‚Äù

---

## üß† RoleBinding vs ClusterRoleBinding

| Feature     | `RoleBinding`                            | `ClusterRoleBinding`                         |
| ----------- | ---------------------------------------- | -------------------------------------------- |
| Scope       | Namespace-scoped                         | Cluster-wide                                 |
| Can bind to | `Role` or `ClusterRole`                  | `ClusterRole` only                           |
| Affects     | Only **one** namespace                   | All namespaces (or cluster-scoped resources) |
| Use case    | Apps with scoped access in one namespace | CI tools, monitoring agents, cluster admins  |

---

## üßæ Example RoleBinding YAML

```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: dev-pod-reader
  namespace: dev
subjects:
- kind: ServiceAccount
  name: app-sa
  namespace: dev
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io
```

‚úÖ This grants `app-sa` ServiceAccount **read-only pod access in the `dev` namespace**.

---

## üîé Key Fields Explained

| Field           | Description                                                      |
| --------------- | ---------------------------------------------------------------- |
| `metadata.name` | Unique name for the binding                                      |
| `namespace`     | Namespace where the permissions will apply                       |
| `subjects`      | The identities (User, Group, or ServiceAccount) granted the role |
| `roleRef`       | Reference to the Role or ClusterRole containing the permissions  |

---

## üéØ Supported `subject` kinds

```yaml
subjects:
- kind: User              # A human user (e.g. SSO/OIDC)
- kind: Group             # A group of users (e.g. dev-team)
- kind: ServiceAccount    # For pods/apps in the cluster
```

Examples:

```yaml
- kind: User
  name: jane@example.com

- kind: Group
  name: devops-team

- kind: ServiceAccount
  name: backend-sa
  namespace: dev
```

---

## ‚úÖ Binding a `ClusterRole` with `RoleBinding`

Yes! You **can** use a `ClusterRole` inside a `RoleBinding` to apply its permissions **within a namespace** only:

```yaml
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: rbac.authorization.k8s.io
```

This allows you to reuse built-in roles like `view`, `edit`, or custom `ClusterRole`s in namespace-only scope.

---

## üß™ Example: Read ConfigMaps and Secrets

### 1. Role (dev namespace)

```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: config-reader
  namespace: dev
rules:
- apiGroups: [""]
  resources: ["configmaps", "secrets"]
  verbs: ["get", "list"]
```

### 2. RoleBinding

```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: bind-config-reader
  namespace: dev
subjects:
- kind: ServiceAccount
  name: ci-sa
  namespace: dev
roleRef:
  kind: Role
  name: config-reader
  apiGroup: rbac.authorization.k8s.io
```

Now `ci-sa` in namespace `dev` can only read configmaps and secrets **in `dev`**.

---

## üìò Built-In ClusterRoles You Can Use

These are **ClusterRoles** you can reference in a `RoleBinding` to **apply them in a specific namespace**:

| Name    | Permissions                           |
| ------- | ------------------------------------- |
| `view`  | Read-only access                      |
| `edit`  | Full CRUD, but no RBAC or node access |
| `admin` | Similar to `edit`, plus RBAC in ns    |

---

## üß™ Testing RoleBinding

Use `kubectl auth can-i` to test access:

```bash
kubectl auth can-i get configmaps --as=system:serviceaccount:dev:ci-sa -n dev
```

---

## üõ° Best Practices

| Best Practice                                 | Why It Matters                               |
| --------------------------------------------- | -------------------------------------------- |
| Use per-app/service account RoleBindings      | Principle of least privilege                 |
| Avoid overuse of `ClusterRole` in RoleBinding | Prefer namespace-scoped `Role` when possible |
| Don‚Äôt bind `cluster-admin` at namespace level | Too powerful even within a namespace         |
| Label RoleBindings clearly                    | Helps with auditing and maintenance          |

---

## üß∞ CLI: Create RoleBinding Easily

```bash
kubectl create rolebinding dev-reader \
  --role=config-reader \
  --serviceaccount=dev:ci-sa \
  --namespace=dev
```

---

## üìú Summary Table

| Field          | Description                              |
| -------------- | ---------------------------------------- |
| `kind`         | `RoleBinding`                            |
| `roleRef.kind` | `Role` or `ClusterRole`                  |
| Scope          | **One namespace only**                   |
| Subject        | `User`, `Group`, or `ServiceAccount`     |
| Common Usage   | App access to resources in one namespace |

---
