___________________________________________________________________________________________________________________________

---

# What is a Gateway?

A **Gateway** is a Kubernetes resource that represents a network gateway/load balancer/proxy that manages inbound (and optionally outbound) traffic for one or more services in the cluster.

* It abstracts the underlying infrastructure (e.g., L4/L7 load balancers).
* Configures how external or internal traffic reaches your services.
* Supports multiple protocols (HTTP, HTTPS, TCP, TLS, UDP).
* More expressive and extensible than traditional Ingress.

---

# How does Gateway relate to GatewayClass?

* **GatewayClass** defines the *type* or *implementation* of a Gateway (which controller manages it).
* A **Gateway** is an instance of a GatewayClass.
* Gateway references its GatewayClass by name (`gatewayClassName`).
* The controller watching the GatewayClass manages all Gateways of that class.

---

# Gateway API Version and Kind

```yaml
apiVersion: networking.x-k8s.io/v1alpha1
kind: Gateway
```

*Note:* The API may be at a newer version (e.g., v1beta1) depending on your Kubernetes version or installed CRDs.

---

# Anatomy of a Gateway Resource

```yaml
apiVersion: networking.x-k8s.io/v1alpha1
kind: Gateway
metadata:
  name: example-gateway
spec:
  gatewayClassName: example-gatewayclass
  listeners:
  - name: http
    protocol: HTTP
    port: 80
    hostname: example.com      # Optional, can restrict listener to a hostname
    allowedRoutes:
      namespaces:
        from: All             # Allow routes from all namespaces
  - name: https
    protocol: HTTPS
    port: 443
    tls:
      certificateRefs:
      - name: example-cert    # TLS cert Secret name reference
    hostname: example.com
    allowedRoutes:
      namespaces:
        from: Selector
        selector:
          matchLabels:
            team: frontend
```

---

# Key Fields Explained

| Field                   | Description                                                                                  |
| ----------------------- | -------------------------------------------------------------------------------------------- |
| `metadata.name`         | Name of the Gateway                                                                          |
| `spec.gatewayClassName` | References the GatewayClass controlling this Gateway                                         |
| `spec.listeners`        | List of listener definitions that specify how traffic is received (protocol, port, hostname) |
| Listener Fields         |                                                                                              |
| - `name`                | Unique name of the listener                                                                  |
| - `protocol`            | Protocol handled (HTTP, HTTPS, TLS, TCP, UDP, etc.)                                          |
| - `port`                | Port number the Gateway listens on                                                           |
| - `hostname`            | (Optional) Hostname or wildcard to filter incoming requests                                  |
| - `tls`                 | TLS settings for the listener (certificates, options)                                        |
| - `allowedRoutes`       | Defines which namespaces or routes are allowed to bind to this listener                      |

---

# Listener Details

* **Protocols supported:** HTTP, HTTPS, TLS, TCP, UDP, etc.
* **TLS support:** You can specify one or more certificate references (usually Secrets).
* **Hostname filtering:** Enables filtering requests based on the hostname.
* **AllowedRoutes:** Controls which routes (e.g., HTTPRoute, TCPRoute) from which namespaces can bind to this listener â€” supports multi-tenancy.

---

# How Gateways Work with Routes

* Gateways expose one or more **listeners**.
* Kubernetes Route resources (e.g., HTTPRoute, TCPRoute) bind to Gateways.
* Routes specify detailed traffic routing rules (path matching, header matching, backend selection).
* This separation improves modularity:

  * Gateway handles network-level configuration and traffic acceptance.
  * Routes handle application-level traffic routing.

---

# Benefits of Gateway Resource

* Supports multiple protocols, not just HTTP.
* Multiple listeners per Gateway for flexible traffic management.
* Fine-grained control over namespaces and route binding.
* Enables multi-tenant scenarios with namespace restrictions.
* Supports advanced features like TLS, hostname matching, and custom extensions.
* Decouples routing from underlying infrastructure.

---

# Example: Gateway with HTTP and HTTPS Listeners

```yaml
apiVersion: networking.x-k8s.io/v1alpha1
kind: Gateway
metadata:
  name: multi-protocol-gateway
spec:
  gatewayClassName: example-gatewayclass
  listeners:
  - name: http-listener
    protocol: HTTP
    port: 80
    allowedRoutes:
      namespaces:
        from: All
  - name: https-listener
    protocol: HTTPS
    port: 443
    tls:
      certificateRefs:
      - name: my-tls-secret
    allowedRoutes:
      namespaces:
        from: Same
```

---

# How Gateway Relates to Ingress and Services

| Feature             | Ingress                     | Gateway (Gateway API)                         |
| ------------------- | --------------------------- | --------------------------------------------- |
| Protocols Supported | HTTP and HTTPS only         | HTTP, HTTPS, TCP, TLS, UDP, and more          |
| Routing Flexibility | Basic path and host routing | Rich routing with multiple route types        |
| Multi-Listener      | Single listener per Ingress | Multiple listeners per Gateway                |
| Multi-Tenancy       | Limited                     | Namespaced route binding and access control   |
| TLS Handling        | Supported but limited       | Multiple certs, SNI, and flexible TLS configs |
| Extensibility       | Limited annotations         | Extensible with parameters and CRDs           |

---

# Current Status and Adoption

* Gateway API (including Gateway resource) is still evolving (alpha/beta stages).
* Supported by various vendors and cloud providers.
* Provides a modern, extensible replacement or complement to Ingress.

---

# Summary Table

| Field/Concept    | Description                                            |
| ---------------- | ------------------------------------------------------ |
| Gateway          | Represents a network gateway/load balancer/proxy       |
| Listeners        | Define protocol, port, hostname, TLS, and route access |
| gatewayClassName | Specifies controller managing the Gateway              |
| AllowedRoutes    | Namespace and route binding restrictions               |
| TLS Certificates | Reference to Kubernetes Secrets for TLS termination    |

---
