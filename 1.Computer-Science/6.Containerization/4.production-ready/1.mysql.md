Perfect — here’s an enhanced **production-grade `mysql-values.yaml`** for the Bitnami MySQL Helm chart that incorporates **secure secret references**, **SSD storage**, **backups**, **high availability features**, and **Prometheus monitoring**.

---

### ✅ Final Production `mysql-values.yaml`

```yaml
# -----------------------------------------------
# 🛡️  1. Secure credentials via existing Secret
# -----------------------------------------------
auth:
  existingSecret: mysql-auth-secret
  username: "admin"
  database: "production_db"

# -----------------------------------------------
# 🏗️  2. High Availability with replication
# -----------------------------------------------
architecture: replication

primary:
  persistence:
    enabled: true
    size: 50Gi
    storageClass: "ssd-storage-class"  # Replace with your fast StorageClass
  resources:
    requests:
      memory: 1Gi
      cpu: 500m
    limits:
      memory: 2Gi
      cpu: 1
  livenessProbe:
    enabled: true
  readinessProbe:
    enabled: true
  podDisruptionBudget:
    create: true
    minAvailable: 1
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/component
                operator: In
                values:
                  - primary
          topologyKey: "kubernetes.io/hostname"

secondary:
  replicaCount: 2
  persistence:
    enabled: true
    size: 50Gi
    storageClass: "ssd-storage-class"
  resources:
    requests:
      memory: 1Gi
      cpu: 500m
    limits:
      memory: 2Gi
      cpu: 1
  livenessProbe:
    enabled: true
  readinessProbe:
    enabled: true
  podDisruptionBudget:
    create: true
    minAvailable: 1
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/component
                operator: In
                values:
                  - secondary
          topologyKey: "kubernetes.io/hostname"

# -----------------------------------------------
# 📦  3. Metrics Exporter + Prometheus Integration
# -----------------------------------------------
metrics:
  enabled: true
  serviceMonitor:
    enabled: true
    namespace: monitoring  # Set to your Prometheus namespace
    interval: 30s
    labels:
      release: prometheus
  image:
    tag: 0.17.2-debian-12-r12
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 100m
      memory: 128Mi

# -----------------------------------------------
# 🧪  4. Extra Config & Logging
# -----------------------------------------------
extraFlags:
  - "--slow-query-log"
  - "--long-query-time=2"

initdbScripts:
  init.sql: |
    CREATE TABLE IF NOT EXISTS startup_check (id INT PRIMARY KEY);
    INSERT INTO startup_check (id) VALUES (1);

# -----------------------------------------------
# 💾 5. Volume permissions
# -----------------------------------------------
volumePermissions:
  enabled: true

# -----------------------------------------------
# 🛠️ 6. Backup Sidecar CronJob
# -----------------------------------------------
backup:
  enabled: true
  schedule: "0 2 * * *" # Every day at 2am
  retentionDays: 7
  image:
    repository: bitnami/mysql
    tag: latest
  command:
    - /bin/bash
    - -c
    - |
      mysqldump -h $MYSQL_HOST -u $MYSQL_USER -p$MYSQL_PASSWORD $MYSQL_DATABASE > /backups/backup-$(date +%F).sql
  persistence:
    enabled: true
    size: 10Gi
    storageClass: "ssd-storage-class"

# -----------------------------------------------
# 🔒 Security Context
# -----------------------------------------------
podSecurityContext:
  enabled: true
  fsGroup: 1001

containerSecurityContext:
  enabled: true
  runAsUser: 1001

updateStrategy:
  type: RollingUpdate
```

---

### 🔐 Secret for `auth.existingSecret`

Create a Kubernetes Secret that holds your root and user passwords:

```bash
kubectl create secret generic mysql-auth-secret \
  --from-literal=mysql-root-password='RootSecret123!' \
  --from-literal=mysql-password='AdminUserPass456!' \
  -n default
```

---

### 🧠 Notes

* Replace `ssd-storage-class` with the name of your **high-performance storage class**, e.g., `premium-rwo`, `fast`, `gp2`, etc.
* Enable Velero or use external volume snapshots for more robust backup/restore if needed.
* Monitor backups using volume mounts or S3 sync in the backup container.
* Integrate with **Prometheus + Grafana** for real-time MySQL performance dashboards.

---

Would you like me to generate a **full Helm chart directory** for this, or set up **restore logic** (from backup folder or object storage)?
