In Helm, **template functions** and **pipelines** allow you to manipulate and format data in your templates using Goâ€™s powerful templating engine (`text/template` and `sprig` functions). This makes your Helm charts flexible and dynamic.

---

## ğŸ›  Template Functions in Helm

Template functions **transform data** inside Helm templates. You use them inside `{{ ... }}` blocks.

### ğŸ”¹ Syntax:

```yaml
{{ functionName argument1 argument2 }}
```

or with pipelines:

```yaml
{{ value | functionName | anotherFunction }}
```

---

## ğŸ§° Common Helm Template Functions

### ğŸ”¤ String Functions

| Function  | Example                                       | Description              |                                 |
| --------- | --------------------------------------------- | ------------------------ | ------------------------------- |
| `upper`   | \`{{ "nginx"                                  | upper }}`â†’`NGINX\`       | Converts string to uppercase    |
| `lower`   | \`{{ "NGINX"                                  | lower }}`â†’`nginx\`       | Converts string to lowercase    |
| `title`   | \`{{ "my app"                                 | title }}`â†’`My App\`      | Capitalizes each word           |
| `trim`    | \`{{ " foo "                                  | trim }}`â†’`foo\`          | Removes leading/trailing spaces |
| `repeat`  | `{{ repeat 3 "ha" }}` â†’ `hahaha`              | Repeats a string N times |                                 |
| `replace` | `{{ replace "foo-bar" "-" "_" }}` â†’ `foo_bar` | Replace substrings       |                                 |

---

### ğŸ”¢ Numeric & Math Functions

| Function | Example                | Description     |
| -------- | ---------------------- | --------------- |
| `add`    | `{{ add 3 4 }}` â†’ `7`  | Adds numbers    |
| `div`    | `{{ div 8 2 }}` â†’ `4`  | Divides numbers |
| `mul`    | `{{ mul 3 2 }}` â†’ `6`  | Multiplies      |
| `mod`    | `{{ mod 10 3 }}` â†’ `1` | Modulo          |

---

### ğŸ§ª Type Checking & Logic

| Function  | Example                               | Description              |                       |
| --------- | ------------------------------------- | ------------------------ | --------------------- |
| `empty`   | `{{ if empty .Values.foo }}`          | Checks if value is empty |                       |
| `default` | \`{{ .Values.env                      | default "dev" }}\`       | Sets a fallback value |
| `hasKey`  | `{{ hasKey .Values "replicaCount" }}` | Key presence in dict     |                       |

---

### ğŸ“¦ List and Dict Functions

| Function | Example                            | Description                                     |
| -------- | ---------------------------------- | ----------------------------------------------- |
| `dict`   | `{{ dict "key1" "val1" }}`         | Create a dictionary                             |
| `list`   | `{{ list 1 2 3 }}`                 | Create a list                                   |
| `pluck`  | `{{ pluck "name" .Values.users }}` | Get value for a specific key from list of dicts |

---

### ğŸ“ File Functions

| Function          | Description                           |
| ----------------- | ------------------------------------- |
| `.Files.Get`      | Gets the contents of a file as string |
| `.Files.GetBytes` | Gets raw bytes of a file              |
| `.Files.Glob`     | Gets list of matching files in chart  |

---

## ğŸ”„ Pipelines in Helm

Pipelines are like Linux pipes (`|`). They pass the output of one function into another.

### ğŸ”¹ Example:

```yaml
{{ .Values.name | upper | quote }}
```

ğŸ” What it does:

1. Gets the value of `.Values.name`
2. Converts it to uppercase
3. Wraps it in quotes

---

### ğŸ“¦ Real-World Example

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-config
data:
  environment: {{ .Values.env | default "development" | quote }}
  app_name: {{ .Chart.Name | upper }}
```

---

## ğŸ”§ Defining Custom Template Helpers (`_helpers.tpl`)

You can define reusable functions in a `_helpers.tpl` file:

```yaml
{{- define "mychart.fullname" -}}
{{ .Release.Name }}-{{ .Chart.Name }}
{{- end }}
```

Then call it in a template:

```yaml
metadata:
  name: {{ include "mychart.fullname" . }}
```

---

## ğŸ§  Debugging Values with `toYaml`

```yaml
{{- toYaml .Values | indent 2 }}
```

âœ… Converts a complex structure to YAML format, very useful for nested config or printing entire `.Values`.

---

## ğŸš€ Summary

* **Functions**: Transform values (strings, numbers, lists, maps).
* **Pipelines**: Chain multiple functions.
* **`_helpers.tpl`**: Define reusable snippets.
* **Common patterns**:

  * `{{ .Values.name | upper }}`
  * `{{ .Values.port | default 80 }}`
  * `{{ include "mychart.fullname" . }}`

---
